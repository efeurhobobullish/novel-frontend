<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Manage Novels</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-5xl mx-auto bg-white p-6 shadow rounded">
    <h1 class="text-2xl font-bold mb-4">ðŸ“š Manage Novels</h1>
    
    <div class="overflow-x-auto">
      <table class="w-full border-collapse">
        <thead>
          <tr class="bg-gray-200 text-left">
            <th class="p-2 border">Title</th>
            <th class="p-2 border">Genre</th>
            <th class="p-2 border">Episodes</th>
            <th class="p-2 border">Actions</th>
          </tr>
        </thead>
        <tbody id="novelTable"></tbody>
      </table>
    </div>
  </div>

  <script>
    const API = "https://novel-api-r1zv.onrender.com/api/novels";
    const token = localStorage.getItem("token");

    async function loadNovels() {
      try {
        const res = await fetch(API, {
          headers: { Authorization: `Bearer ${token}` }
        });
        const novels = await res.json();

        document.getElementById("novelTable").innerHTML = novels.map(n => `
          <tr class="border-b">
            <td class="p-2">${n.title}</td>
            <td class="p-2">${n.genre || "N/A"}</td>
            <td class="p-2">${n.episodes ? n.episodes.length : 0}</td>
            <td class="p-2">
              <a href="episodes.html?novelId=${n._id}" 
                 class="text-blue-500 hover:underline">âž• Add Episode</a>
            </td>
          </tr>
        `).join("");
      } catch (err) {
        document.getElementById("novelTable").innerHTML = 
          `<tr><td colspan="4" class="p-2 text-red-500">Error loading novels</td></tr>`;
      }
    }

    loadNovels();
  </script>
</body>
</html>
